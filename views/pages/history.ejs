<!DOCTYPE HTML>
<html>
  <%- include('../partials/head') %>
  <%- include('../partials/header') %>

  <!-- Main -->
  <article id="main">
    <header>
      <h2>Meals History</h2>
      <p class="white-text">Select a date range to view your meal history:</p>
    </header>

    <section class="wrapper style5">
      <div class="inner">
        
        <!-- Date Picker Section -->
        <form action="/home/mealsHistory" method="GET">
          <label for="startDate">Start Date:</label>
          <input type="date" name="startDate" required>
          
          <label for="endDate">End Date:</label>
          <input type="date" name="endDate" required>
          
          <button type="submit">Get Meals</button>
        </form>

        <!-- If mealsData is not present, show only the date picker form -->
        <% if (!mealsData) { %>
          <p>Please select a date range to view your meal history.</p>
        <% } else { %>

          <!-- Graph Placeholder (You'll add the graph logic here) -->
          <div id="meal-history-graph"></div>

          <!-- Scrollable Meal Squares -->
          <div class="meal-squares">
            <% mealsData.forEach(day => { %>
              <div class="meal-day">
                <h3><%= day.meal_date %></h3>
                <% day.meals.forEach(meal => { %>
                  <p><strong>Meal Type:</strong> <%= meal.meal_type %></p>
                  <p><strong>Description:</strong> <%= meal.description %></p>
                  <p><strong>Glucose After Meal:</strong> <%= meal.glucose_after_meal %></p>
                <% }) %>
              </div>
            <% }) %>
          </div>

        <% } %>
      </div>
    </section>
  </article>

  <%- include('../partials/footer') %>
</html>
