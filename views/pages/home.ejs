<!DOCTYPE HTML>
<html>
  <%- include('../partials/head') %>
  <%- include('../partials/header') %>

  <!-- Main -->
  <article id="main">
    <header>
      <h2>Personal Space</h2>
      <p class="white-text">Please update your daily meals:</p>
    </header>
    <section class="wrapper style5">
      <div class="inner">
        <!-- Image URL Input Form -->
        <h3>Enter the URL of your meal picture</h3>
        
        <form id="uploadForm" action="/home/addNewMeal" method="POST" enctype="multipart/form-data">
          <div class="upload-square" onclick="document.getElementById('imageUpload').click();">
              <span id="upload-text">Click to upload</span>
          </div>
          <input type="file" id="imageUpload" name="imageFile" accept="image/*" required style="display:none;">

          <!-- Date Picker -->
          <div class="form-group">
            <label for="mealDate">Select the Meal Date:</label>
            <input type="date" id="mealDate" name="mealDate" required>
          </div>

          <!-- Meal Type Dropdown -->
          <div class="form-group">
            <label for="mealType">Meal Type:</label>
            <select id="mealType" name="mealType" required>
              <option value="" disabled selected>Choose a meal type</option>
              <option value="breakfast">Breakfast</option>
              <option value="lunch">Lunch</option>
              <option value="dinner">Dinner</option>
            </select>
          </div>

          <!-- Glucose Level Input -->
          <div class="form-group">
            <label for="glucoseLevel">Glucose 2 hours after meal:</label>
            <input type="number" id="glucoseLevel" name="glucoseLevel" placeholder="Enter glucose level" required>
          </div>

          <!-- Submit Button -->
          <div class="form-group">
            <button type="submit">Analyze Image</button>
          </div>
        </form>

        <script>
          document.getElementById('imageUpload').addEventListener('change', function() {
              const fileName = this.files[0].name;
              document.getElementById('upload-text').textContent = fileName;
          });
      </script>

        <!-- Display the analyzed food tag -->
        <% if (typeof foodTag !== 'undefined') { %>
          <p>Detected food: <strong><%= foodTag %></strong></p>
        <% } %>
      </div>
    </section>
  </article>

  <%- include('../partials/footer') %>
</body>
</html>
